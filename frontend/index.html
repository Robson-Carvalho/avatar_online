<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Avatar Online</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css" />
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
  <link rel="stylesheet" href="./styles/styles.css" />
</head>

<body>
  <div id="container-loading"
    class="hidden min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 flex items-center justify-center p-4">
    <div
      class="bg-white/80 backdrop-blur-lg rounded-2xl shadow-xl p-8 w-full max-w-md border border-slate-100 text-center">
      <div class="w-32 h-32 mx-auto mb-6 rounded-full overflow-hidden border-4 border-slate-200 shadow-sm">
        <img
          src="https://d2d7ho1ae66ldi.cloudfront.net/ArquivoNoticias/21587cd0-e5fc-11ed-aa6e-9587410378a2/avatar-a-lenda-de-aang-animacao.jpg"
          alt="Avatar Online" class="w-full h-full object-cover" />
      </div>

      <div class="flex flex-col items-center space-y-4">
        <div class="animate-spin rounded-full h-12 w-12 border-4 border-indigo-400 border-t-transparent"></div>
        <div>
          <h2 class="text-2xl font-bold text-slate-800 mb-2">
            Avatar Online
          </h2>
          <p class="text-slate-600 text-lg">
            Tentando conectar com o servidor...
          </p>
        </div>
      </div>
    </div>
  </div>

  <div id="container-signIn"
    class="hidden min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 flex items-center justify-center p-4">
    <div class="bg-white/80 backdrop-blur-lg rounded-2xl shadow-xl p-8 w-full max-w-md border border-slate-100">
      <div class="text-center mb-8">
        <h2 class="text-2xl font-bold text-slate-800 mb-2">Entrar</h2>
        <p class="text-slate-600">Acesse sua conta</p>
      </div>

      <form class="space-y-4">
        <div>
          <label class="block text-slate-700 text-sm font-medium mb-2">Nickname</label>
          <input id="nickname-login" type="text"
            class="w-full bg-white/60 border border-slate-200 rounded-lg px-4 py-3 text-slate-800 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-indigo-300 focus:border-transparent transition-all" />
        </div>

        <div>
          <label class="block text-slate-700 text-sm font-medium mb-2">Password</label>
          <input id="password-login" type="password"
            class="w-full bg-white/60 border border-slate-200 rounded-lg px-4 py-3 text-slate-800 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-indigo-300 focus:border-transparent transition-all" />
        </div>

        <button type="submit" onclick="handleLogin(event)"
          class="w-full bg-gradient-to-r from-indigo-400 to-purple-400 hover:from-indigo-500 hover:to-purple-500 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-200 transform hover:scale-105 active:scale-95 shadow-md">
          üîê Entrar
        </button>
      </form>

      <div class="mt-6 text-center">
        <span class="text-slate-600">J√° tem conta?</span>
        <button onclick="showSignUp()"
          class="text-indigo-500 hover:text-indigo-600 font-medium ml-1 underline transition-colors">
          Register
        </button>
      </div>
    </div>
  </div>

  <div id="container-signUp"
    class="hidden min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 flex items-center justify-center p-4">
    <div class="bg-white/80 backdrop-blur-lg rounded-2xl shadow-xl p-8 w-full max-w-md border border-slate-100">
      <div class="text-center mb-8">
        <h2 class="text-2xl font-bold text-slate-800 mb-2">Registrar</h2>
        <p class="text-slate-600">Crie sua conta</p>
      </div>

      <form class="space-y-4">
        <div>
          <label class="block text-slate-700 text-sm font-medium mb-2">Name</label>
          <input type="text" id="name-register"
            class="w-full bg-white/60 border border-slate-200 rounded-lg px-4 py-3 text-slate-800 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-indigo-300 focus:border-transparent transition-all" />
        </div>

        <div>
          <label class="block text-slate-700 text-sm font-medium mb-2">Nickname</label>
          <input type="text" id="nickname-register"
            class="w-full bg-white/60 border border-slate-200 rounded-lg px-4 py-3 text-slate-800 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-indigo-300 focus:border-transparent transition-all" />
        </div>

        <div>
          <label class="block text-slate-700 text-sm font-medium mb-2">Email</label>
          <input type="email" id="email-register"
            class="w-full bg-white/60 border border-slate-200 rounded-lg px-4 py-3 text-slate-800 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-indigo-300 focus:border-transparent transition-all" />
        </div>

        <div>
          <label class="block text-slate-700 text-sm font-medium mb-2">Password</label>
          <input type="password" id="password-register"
            class="w-full bg-white/60 border border-slate-200 rounded-lg px-4 py-3 text-slate-800 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-indigo-300 focus:border-transparent transition-all" />
        </div>

        <button type="submit" onclick="handleRegister(event)"
          class="w-full bg-gradient-to-r from-indigo-400 to-purple-400 hover:from-indigo-500 hover:to-purple-500 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-200 transform hover:scale-105 active:scale-95 shadow-md">
          üìù Registrar
        </button>
      </form>

      <div class="mt-6 text-center">
        <span class="text-slate-600">J√° tem uma conta?</span>
        <button onclick="showSignIn()"
          class="text-indigo-500 hover:text-indigo-600 font-medium ml-1 underline transition-colors">
          Entrar
        </button>
      </div>
    </div>
  </div>

  <div id="container-dashboard"
    class="hidden min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 flex flex-col">
    <header
      class="w-full bg-white/80 backdrop-blur-lg shadow-lg border-b border-slate-200 px-6 py-4 flex items-center justify-between">
      <div class="flex flex-col">
        <span class="text-2xl font-bold text-slate-800"> Avatar Online </span>

        <p>
          <span class="font-medium text-slate-800"> User ID: </span>
          <span id="user_id" class="text-sm font-regular text-slate-600">
          </span>
        </p>

        <p>
          <span class="font-medium text-slate-800"> Nickname: </span>
          <span id="nickname_dash" class="text-sm font-regular text-slate-600">
          </span>
        </p>

        <p>
          <span class="font-medium text-slate-800"> Endere√ßo: </span>
          <span id="address_dash" class="text-sm font-regular text-slate-600">
          </span>
        </p>

        <div class="flex items-center gap-2 text-sm text-gray-700">
          <div class="w-2.5 h-2.5 rounded-full bg-green-500 animate-pulse"></div>
          <p>
            Ping:
            <span id="ping-dash" class="">0 ms</span>
          </p>
        </div>
      </div>

      <nav class="space-x-6">
        <button onclick="handleJoinInQueue()"
          class="text-slate-700 hover:text-indigo-500 font-medium transition-colors">
          Jogar
        </button>
        <button onclick="handleGetDeck()" class="text-slate-700 hover:text-indigo-500 font-medium transition-colors">
          Deck
        </button>
        <button onclick="handleOpenPackage()"
          class="text-slate-700 hover:text-indigo-500 font-medium transition-colors">
          Pacote
        </button>
        <button onclick="handleGetCards()" class="text-slate-700 hover:text-indigo-500 font-medium transition-colors">
          Cartas
        </button>

        <button onclick="handleOpenBlockchain()"
          class="text-slate-700 hover:text-indigo-500 font-medium transition-colors">
          Blockchain
        </button>

        <button onclick="handleLogout()" class="text-slate-700 hover:text-rose-500 font-medium transition-colors">
          Sair
        </button>
      </nav>
    </header>

    <div class="px-6 py-4 flex flex-col gap-8">
      <p class="text-ms font-medium text-slate-600">
        Domine os quatro elementos! üåÄ
      </p>

      <!-- Modal de aceitar troca -->
      <div id="your-accept-exchange"
        class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-xl shadow-xl p-6 w-full max-w-4xl flex flex-col gap-6">

          <!-- T√≠tulo -->
          <h2 class="text-2xl font-bold text-center text-gray-800">Proposta de Troca</h2>

          <!-- √Årea dos cards -->
          <div class="flex flex-row items-center justify-center gap-6 flex-wrap">
            <!-- Card jogador 1 -->
            <div class="flex flex-col items-center flex-shrink-0">
              <div id="card1-exchange">
                <!-- Render card1 aqui -->
              </div>
              <p class="mt-2 text-sm text-gray-600 font-medium">Carta do outro jogador</p>
            </div>

            <!-- Seta de troca -->
            <div class="text-3xl font-bold text-gray-500 select-none">üîÑ</div>

            <!-- Card jogador 2 -->
            <div class="flex flex-col items-center flex-shrink-0">
              <div id="card2-exchange">
                <!-- Render card2 aqui -->
              </div>
              <p class="mt-2 text-sm text-gray-600 font-medium">Sua carta</p>
            </div>
          </div>

          <!-- Bot√µes -->
          <div class="flex justify-end gap-4">
            <button onclick="cancelToServerExchangeCard()"
              class="px-5 py-2 bg-gray-300 text-gray-800 rounded-lg hover:bg-gray-400 transition-colors">
              Cancelar
            </button>
            <button onclick="sendToServerExchangeCard()"
              class="px-5 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors">
              Aceitar
            </button>
          </div>

        </div>
      </div>


      <div id="modal-cards-player" class="fixed inset-0 hidden items-center justify-center bg-black bg-opacity-50 z-50">
        <div class="bg-white w-[80%] max-w-8xl rounded-xl shadow-lg p-6 relative">
          <!-- Bot√£o de fechar -->
          <button id="close-modal-cards" class="absolute top-3 right-3 text-gray-500 hover:text-gray-800 transition">
            ‚úñ
          </button>

          <h2 class="text-2xl font-bold text-gray-800 mb-4">Cartas do Jogador</h2>

          <!-- Container das cartas -->
          <div id="cards-to-player"
            class="flex flex-wrap gap-4 items-center justify-center overflow-y-auto max-h-[70vh] p-2">
          </div>

        </div>
      </div>

      <div id="online-users-container" class="min-h-[150px] p-4 flex flex-col gap-2">
        <!-- usu√°rios online ser√£o renderizados aqui -->
      </div>
    </div>

    <div id="battlefield">
      <!-- Tela de loading -->
      <div id="loading-join-game"
        class="hidden fixed inset-0 z-50 flex items-center justify-center bg-gradient-to-b from-white/90 to-gray-100/90 backdrop-blur-sm">
        <div class="flex flex-col items-center gap-6">

          <img src="./assets/fight.gif" alt="loading" class="w-[min(700px,90vw)] h-auto object-contain">

          <div class="text-2xl font-medium text-gray-700">
            Buscando partida‚Ä¶
          </div>

        </div>
      </div>

      <!-- Campo de batalha modal -->
      <div id="battle"
        class="hidden fixed inset-0 z-40 flex flex-col justify-between bg-gradient-to-br from-slate-100 to-slate-300 shadow-2xl rounded-2xl border border-gray-200 p-4">

        <!-- Header -->
        <div
          class="flex items-center justify-between bg-white/80 backdrop-blur-sm rounded-xl p-3 shadow-sm border border-gray-200">
          <!-- Ping -->
          <div class="flex flex-row items-center gap-4">
            <div class="flex items-center gap-2 text-sm text-gray-700">
              <div class="w-2.5 h-2.5 rounded-full bg-green-500 animate-pulse"></div>
              <span id="ping-game" class="">Ping: 32ms</span>
            </div>

            <div class="flex flex-row items-center gap-2 text-sm text-gray-700">
              <p>Voc√™</p>
              <span id="player-points">0</span>
              <span>|</span>
              <p>Advers√°rio</p>
              <span id="opponent-points">0</span>
            </div>
          </div>


          <!-- T√≠tulo -->
          <div class="text-lg font-semibold text-gray-800 tracking-wide select-none">
            Campo de Batalha ‚öîÔ∏è
          </div>

          <!-- Bot√£o render-se -->
          <button id="surrender-btn" onclick="surrender()"
            class="px-4 py-1.5 rounded-lg bg-red-500 text-white text-sm font-medium hover:bg-red-600 transition">
            Render-se
          </button>
        </div>

        <!-- √Årea principal do campo -->
        <div id="battle-area"
          class="flex-1 flex flex-col justify-center items-center p-6 bg-white/60 backdrop-blur-sm rounded-xl mt-4 mb-4 border border-gray-200 shadow-inner">


          <div class="flex flex-row justify-between items-center mb-8">
            <div id="activate-player-card" class="px-6 py-6 border-2 border-dashed border-gray-400 rounded-2xl bg-white/40 backdrop-blur-sm 
                   flex justify-center items-center transition-all duration-300 ease-in-out hover:border-green-500 hover:bg-green-50 
                     min-h-[260px] min-w-[240px] shadow-inner">
              <p class="text-gray-500 text-sm">Arraste sua carta para c√°</p>
            </div>

            <div class="mx-8">
              <button id="button-player-card" onclick="handlePlayCard()"
                class="px-6 py-2 rounded-xl bg-green-500 text-white font-semibold shadow-md hover:bg-green-600 active:scale-95 transition disabled:bg-gray-400 disabled:cursor-not-allowed disabled:shadow-none">
                Jogar
              </button>


            </div>

            <div id="opponent-card" class="px-6 py-6 gap-4 border-2 border-dashed border-gray-400 rounded-2xl bg-gray-100/60 backdrop-blur-sm
                     flex justify-center items-center transition-all duration-300 ease-in-out hover:border-red-500 hover:bg-red-50 
                     min-h-[260px] min-w-[240px] shadow-inner">
              <p class="text-gray-500 text-sm">Carta do oponente</p>
            </div>
          </div>

          <div id="deck-player"
            class="flex flex-row gap-4 px-6 py-4 border-2 border-dashed border-gray-400 rounded-lg ">
            <!-- popular com o deck do player, para a arrasta para ativar  -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading Open Package -->
  <div id="loadingOpenPackage"
    class="hidden fixed inset-0 bg-black/70 flex flex-col items-center justify-center z-50 gap-4">

    <img src="./assets/loading.gif" alt="" class="w-[50vw] max-w-[500px] h-auto object-contain">

    <!-- Barra de loading -->
    <div class="w-[60%] h-3 bg-white/30 rounded-full overflow-hidden">
      <div class="h-full bg-white animate-loadingBar"></div>
    </div>

  </div>

  <style>
    @keyframes loadingBar {
      0% {
        transform: translateX(-100%);
      }

      50% {
        transform: translateX(0%);
      }

      100% {
        transform: translateX(100%);
      }
    }

    .animate-loadingBar {
      animation: loadingBar 3s linear infinite;
    }
  </style>


  <!-- Overlay para o Hist√≥rico Blockchain -->
<div id="modalHistoryBlockchainOverlay"
  class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-40 transition-opacity duration-300"></div>

<!-- Modal Hist√≥rico Blockchain -->
<div id="modalHistoryBlockchain"
  class="hidden fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-11/12 max-w-6xl bg-white rounded-xl shadow-2xl z-50 transition-all duration-300 scale-95 opacity-0">
  
  <div class="flex items-center justify-between p-6 border-b border-slate-200">
    <h2 class="text-2xl font-bold text-slate-800">Hist√≥rico da Blockchain</h2>
    <button onclick="closeModalHistoryBlockchain()" class="text-slate-400 hover:text-slate-600 transition-colors">
      <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
      </svg>
    </button>
  </div>

  <div class="p-6 max-h-[70vh] overflow-y-auto">
    <div id="timelineContainer" class="space-y-4"></div>
  </div>

  <div class="flex justify-end gap-3 p-6 border-t border-slate-200">
    <button onclick="closeModalHistoryBlockchain()"
      class="px-6 py-3 text-slate-600 hover:text-slate-800 transition-colors font-medium">
      Fechar
    </button>
  </div>
</div>

  <!-- Overlay -->
  <div id="modal-overlay"
    class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-50 transition-opacity duration-300"></div>

  <!-- Modal Deck -->
  <div id="deck-modal"
    class="hidden fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-11/12 max-w-6xl bg-white rounded-xl shadow-2xl z-50 transition-all duration-300 scale-95 opacity-0">

    <div class="flex items-center justify-between p-6 border-b border-slate-200">
      <h3 class="text-xl font-bold text-slate-800">Montar Deck</h3>
      <button onclick="closeModal('deck-modal')" class="text-slate-400 hover:text-slate-600 transition-colors">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
    </div>

    <div class="p-6">
      <!-- √°rea do deck -->
      <div class="grid grid-cols-5 gap-4">
        <div
          class="deck-card-1 rounded-xl border-2 border-dashed border-gray-400 bg-gray-50 min-w328 min-h-[248px] flex justify-center items-center text-gray-400 select-none ">
          Arraste aqui
        </div>

        <div
          class="deck-card-2 rounded-xl border-2 border-dashed border-gray-400 bg-gray-50 min-h-[248px] flex justify-center items-center text-gray-400 select-none">
          Arraste aqui
        </div>

        <div
          class="deck-card-3 rounded-xl border-2 border-dashed border-gray-400 bg-gray-50 min-h-[248px] flex justify-center items-center text-gray-400 select-none">
          Arraste aqui
        </div>

        <div
          class="deck-card-4 rounded-xl border-2 border-dashed border-gray-400 bg-gray-50 min-h-[248px] flex justify-center items-center text-gray-400 select-none">
          Arraste aqui
        </div>

        <div
          class="deck-card-5 rounded-xl border-2 border-dashed border-gray-400 bg-gray-50 min-h-[248px] flex justify-center items-center text-gray-400 select-none">
          Arraste aqui
        </div>
      </div>


      <div id="deck-cards-user"
        class="mt-6 flex flex-row justify-center gap-4 flex-wrap w-full h-64 p-4 border-2 border-dashed border-gray-400 rounded-lg overflow-y-auto">
        <!-- cartas para puxar e colocar no drag -->
      </div>

    </div>


    <div class="flex justify-end gap-3 p-6 border-t border-slate-200">
      <button onclick="closeModal('deck-modal')"
        class="px-4 py-2 text-slate-600 hover:text-slate-800 transition-colors">
        Cancelar
      </button>
      <button onclick="handleUpdateDeck()"
        class="px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 transition-colors">
        Salvar Deck
      </button>
    </div>
  </div>

  <!-- Modal Pacote -->
  <div id="package-modal"
    class="hidden fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-11/12 max-w-6xl bg-white rounded-xl shadow-2xl z-50 transition-all duration-300 scale-95 opacity-0">
    <div class="flex items-center justify-between p-6 border-b border-slate-200">
      <h3 class="text-xl font-bold text-slate-800">Pacote de Cartas</h3>
      <button onclick="closeModal('package-modal')" class="text-slate-400 hover:text-slate-600 transition-colors">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
    </div>
    <div class="p-6 max-h-96 overflow-y-auto">
      <p class="text-slate-600 mb-4">Suas 5 cartas adquiridas:</p>
      <!-- cartas aqui -->

      <div id="package-cards" class="flex flex-row justify-center gap-4 w-full">

      </div>
    </div>
    <div class="flex justify-end gap-3 p-6 border-t border-slate-200">
      <button onclick="closeModal('package-modal')"
        class="px-4 py-2 text-slate-600 hover:text-slate-800 transition-colors">
        Fechar
      </button>
    </div>
  </div>

  <!-- Modal Cartas -->
  <div id="cards-modal"
    class="hidden fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-11/12 max-w-6xl bg-white rounded-xl shadow-2xl z-50 transition-all duration-300 scale-95 opacity-0">
    <div class="flex items-center justify-between p-6 border-b border-slate-200">
      <h3 class="text-xl font-bold text-slate-800">Minhas Cartas</h3>
      <button onclick="closeModal('cards-modal')" class="text-slate-400 hover:text-slate-600 transition-colors">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
    </div>
    <div class="p-6 max-h-96 overflow-y-auto">
      <p class="text-slate-600 mb-4">Suas cartas coletadas:</p>

      <div id="user-cards" class="flex flex-wrap justify-center items-start gap-4 w-full">
        <!-- cartas ser√£o inseridas aqui -->
      </div>

    </div>
    <div class="flex justify-end gap-3 p-6 border-t border-slate-200">
      <button onclick="closeModal('cards-modal')"
        class="px-4 py-2 text-slate-600 hover:text-slate-800 transition-colors">
        Fechar
      </button>
    </div>
  </div>

  </div>


  <script src="./scripts/data/localstorage.js"></script>
  <script src="./scripts/game/index.js"></script>
  <script src="./scripts/handlers/received/received.js"></script>
  <script src="./scripts/handlers/received/received.js"></script>
  <script src="./scripts/handlers/send/card.js"></script>
  <script src="./scripts/handlers/send/deck.js"></script>
  <script src="./scripts/handlers/send/game.js"></script>
  <script src="./scripts/handlers/send/user.js"></script>
  <script src="./scripts/handlers/send/status.js"></script>
  <script src="./scripts/notify/index.js"></script>
  <script src="./scripts/operations/index.js"></script>
  <script src="./scripts/pub_sub/pub_sub.js"></script>
  <script src="./scripts/view/dashboard.js"></script>
  <script src="./scripts/view/loading.js"></script>
  <script src="./scripts/view/dashboard.js"></script>
  <script src="./scripts/global/index.js"></script>
  <script src="./scripts/view/templates/cardsTemplate.js"></script>
  <script src="./scripts/view/templates/onlineUserTemplate.js"></script>
  <script src="./scripts/view/deck_modal/dragDeck.js"></script>
  <script src="./scripts/view/users/index.js"></script>
</body>

</html>